var app=angular.module("kentendo.playground",["kentendo.playground.config","kentendo.playground.controllers","kentendo.playground.directives","ui.ace"]);angular.module("kentendo.playground").config(function($locationProvider){$locationProvider.html5Mode(!0)}),angular.module("kentendo.playground").run(function($rootScope){$rootScope.aceHtmlLoaded=function(editor){$rootScope.htmlEditor=editor,$rootScope.htmlEditor.setShowPrintMargin(!1),$rootScope.htmlEditor.setTheme("ace/theme/idle_fingers"),$rootScope.htmlEditor.getSession().setMode("ace/mode/html")},$rootScope.aceCssLoaded=function(editor){$rootScope.cssEditor=editor,$rootScope.cssEditor.setShowPrintMargin(!1),$rootScope.cssEditor.setTheme("ace/theme/idle_fingers"),$rootScope.cssEditor.getSession().setMode("ace/mode/css")},$rootScope.aceJsLoaded=function(editor){$rootScope.jsEditor=editor,$rootScope.jsEditor.setShowPrintMargin(!1),$rootScope.jsEditor.setTheme("ace/theme/idle_fingers"),$rootScope.jsEditor.getSession().setMode("ace/mode/javascript")}}),angular.module("kentendo.playground.config",[]).constant("PlaygroundConfig",{editorTheme:"ace/theme/eclipse",playgroundUrl:"/api"}),angular.module("kentendo.playground.controllers",[]),angular.module("kentendo.playground.controllers").controller("MainController",["$scope","$location","$http","$templateCache","$compile","$timeout","PlaygroundAPI","LertService",function($scope,$location,$http,$templateCache,$compile,$timeout,playgroundAPI,lerts){var params=$location.search();$scope.playground={_id:null,name:"",user:"kentendo",html:"",css:"",js:""},$scope.autoRefresh=!0,$scope.showOutput="false"===params.output?!1:!0,$scope.showHTML="false"===params.html?!1:!0,$scope.showCSS="false"===params.css?!1:!0,$scope.showJS="false"===params.js?!1:!0,$scope.showCode=!0,$scope.toolHeight="33.3333%",$scope.iframeWidth="66.6666%",$scope.edited=!1,$scope.$watchGroup(["showHTML","showCSS","showJS"],function(){$scope.toolHeight=$scope.getToolHeight(),$scope.toolWidth=$scope.getToolWidth(),$scope.iframeWidth=$scope.getIframeWidth(),$scope.showCode=0===$scope.getToolCount()?!1:!0}),$scope.onHtmlChange=function(){$scope.playground.html=$scope.htmlEditor.getValue()},$scope.onCssChange=function(){$scope.playground.css=$scope.cssEditor.getValue()},$scope.onJsChange=function(){$scope.playground.js=$scope.jsEditor.getValue()},$scope.getToolCount=function(){return Number($scope.showHTML)+Number($scope.showCSS)+Number($scope.showJS)},$scope.getToolHeight=function(){return String(Number(100/$scope.getToolCount()).toFixed(4))+"%"},$scope.getToolWidth=function(){return $scope.showOutput?"33.3333%":"100%"},$scope.getIframeWidth=function(){return 0===$scope.getToolCount()?"100%":"66.6666%"},$scope.$watch("playground.name",function(){$scope.edited=!0}),$scope.$watchGroup(["playground.html","playground.css","playground.js"],function(){$scope.autoRefresh&&$scope.refresh(),$scope.edited=!0}),$scope.get=function(id){playgroundAPI.get(id).success(function(data,status,headers,config){data.success?($scope.playground=data.data,$scope.edited=!1,lerts.lert("success","Loaded "+$scope.playground.name)):(lerts.lert("error","Not found"),$location.path("/"))}).error(function(data,status,headers,config){lerts.lert("error","Could not connect to api")})},$scope.refresh=function(){var iframe=document.getElementById("iframe");iframe.srcdoc="<!DOCTYPE html><html><head><style>"+$scope.playground.css+"</style></head><body>"+$scope.playground.html+"<script>"+$scope.playground.js+"</script></body></html>"},$scope.create=function(){playgroundAPI.create($scope.playground).success(function(data,status,headers,config){0===data.length?$scope["new"]():(lerts.lert("success","Created dat"),$scope.playground._id=data.data,$location.path(data.data))}).error(function(data,status,headers,config){lerts.lert("error","Couldn't create dat")})},$scope.update=function(){playgroundAPI.update($scope.playground).success(function(data,status,headers,config){lerts.lert("success","Saved dat"),$scope.edited=!1}).error(function(data,status,headers,config){lerts.lert("error","Couldn	 save dat")})},$scope.save=function(){return $scope.edited===!1?(lerts.lert("error","No edits"),!1):""===$scope.playground.html&&""===$scope.playground.css&&""===$scope.playground.js?(lerts.lert("error","Das blank"),!1):(""===$scope.playground.name&&($scope.playground.name=prompt("Name dat or don't do dat...")),void($scope.playground._id?$scope.update():$scope.create()))},$location.path()?$scope.get($location.path().slice(1)):lerts.lert("success","Do dis")}]),angular.module("kentendo.playground.directives",[]),angular.module("kentendo.playground.directives").directive("editor",function(){return{restrict:"A",templateUrl:"templates/menu.html",controller:function($scope){this.onChange=function(sequenceIndex,taskIndex){$scope.setSequenceTask(sequenceIndex,taskIndex)}},controllerAs:"menuController"}}),app.factory("PlaygroundAPI",["$http",function($http){var apiUrl="http://playground.kennycosca.com/api/";return{get:function(id){return $http({method:"get",url:apiUrl+id})},create:function(data){return delete data._id,$http({method:"post",url:apiUrl,data:data})},update:function(data){var id=data._id;return delete data._id,$http({method:"post",url:apiUrl+id,data:data})}}}]);